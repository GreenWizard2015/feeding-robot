# Распознавание меток на роботе

## [Commit #1]()

Основные моменты:

- Используется очень примитивная сеть на базе архитектуры U-net. На вход поступает BGR-изображение (из предобратки, только нормирование диапазона до 0..1) размером 224*224, а на выходе получаем пиксельную карту для 8 классов/точек + 1 карта для "фона".
  
- Локализация точки из карты сегментации является весьма сложным (максимум не всегда указывает на нужную точку, особенно при масштабировании), поэтому было решено находить "центр масс" предсказаний. Так же, данный подход используется и на этапе обучения сети, что повысило точность и стабильность. Хоть dice loss уже учитывает целевую форму распределения вероятностей, но расчёт центра масс позволил убрать артефакты (особенно в точках 7 и 8, которые видны значительно реже).

- Датасет наполнялся итеративно. Сначала было размечено 10 кадров и обучена на них сеть. Затем было отобрано ещё 10 кадров на которых сеть делала заметные ошибки и сеть обучалась вновь. Сейчас датасет содержит 91 кадр. 67 из них извлечены с первого видео-файла (около 1250 кадров), НО сеть уже способна сама доразметить данные с достаточно высокой точностью.

- Использовалась примитивная, но весьма сильная, аугментация данных. Конечно, некоторые нюансы реализации являются весьма сомнительными, но даже это позволило добиться корректных предсказаний даже на видео с другой камеры (не всегда, но в основном).

Видео-файлы и обученные модели можно [скачать отдельно](url).

## Планы и идеи

- Автоматически разметить больше данных, используя текущую версию сети. В `CAnchorsDetector.combinedDetections` реализован прототип данного функционала, но необходимо корректно реализовать процесс обучения на сгенерированных данных. Например, учесть возможность наличия ошибок.

- Использовать дискриминатор, как в GAN, чтоб получить adversarial loss. Такой loss возможно даст дополнительный отклик на изменения в сети.

- Робот является жёсткой конструкцией и возможные конфигурации расположения меток ограничены ею, поэтому можно обучить модель, например, определять является ли валидным заданное расположение меток. Подобная модель сможет пригодиться не только для распознавания, как доп. loss, но и, например, при планировании движений манипулятора.